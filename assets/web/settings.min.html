<!DOCTYPE html><html lang="en"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Shakal Cam Settings</title><style>:root{--background-color:#000;--text-color:#fff;--accent-color:#444;--success-color:#28a745}body,html{margin:0;padding:0;background-color:var(--background-color);color:var(--text-color);font-family:monospace}.header{padding:20px;display:flex;justify-content:space-between;align-items:center}.header h1{margin:0}.header-buttons{display:flex;gap:10px}.button{background-color:var(--text-color);color:var(--background-color);border:none;padding:10px 20px;font-size:18px;font-weight:700;cursor:pointer;font-family:monospace;text-decoration:none;display:inline-block;box-shadow:5px 5px 0 0 rgba(0,0,0,.2)}.button:hover{box-shadow:4px 4px 0 0 rgba(0,0,0,.3)}.button:active{box-shadow:0 0 0 0 rgba(0,0,0,.3);transform:translate(5px,5px)}.button-success{background-color:var(--success-color);color:#fff}.settings-container{padding:20px;max-width:800px;margin:0 auto}.settings-section{margin-bottom:30px;background-color:var(--accent-color);padding:20px;border-radius:4px}.settings-section h2{margin-top:0;margin-bottom:15px;border-bottom:1px solid var(--text-color);padding-bottom:10px}.palette-container{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px}.color-picker{display:flex;flex-direction:column;align-items:center;gap:5px}.color-block{width:60px;height:60px;border:2px solid var(--text-color);position:relative;cursor:pointer}.color-input{opacity:0;position:absolute;top:0;left:0;width:100%;height:100%;cursor:pointer}.preview-section{margin-top:20px;display:flex;justify-content:center;flex-direction:column;align-items:center}.preview-gradient{width:100%;height:60px;background:linear-gradient(to right,#000,#222,#444,#666,#888,#aaa,#ccc,#fff);margin-bottom:20px}.preview-color-values{display:flex;flex-wrap:wrap;gap:10px;font-size:12px;margin-top:10px;width:100%}.preview-color-value{background:rgba(255,255,255,.1);padding:5px;border-radius:3px}.notification{position:fixed;top:20px;right:20px;padding:10px 20px;background-color:var(--success-color);color:#fff;border-radius:4px;box-shadow:0 2px 10px rgba(0,0,0,.2);transform:translateY(-100px);opacity:0;transition:transform .3s,opacity .3s}.notification.show{transform:translateY(0);opacity:1}@media (max-width:600px){.header{flex-direction:column;gap:10px}.header-buttons{width:100%;flex-direction:column}.button{width:100%;text-align:center}.palette-container{justify-content:center}}</style><div class="header"><h1>Settings</h1><div class="header-buttons"><button id="resetPaletteBtn" class="button">Reset Palette</button> <button id="savePaletteBtn" class="button button-success">Save Changes</button> <a href="/" class="button">Back to Camera</a> <a href="/gallery" class="button">Gallery</a></div></div><div class="settings-container"><div class="settings-section"><h2>Color Palette Settings</h2><p>Customize the 8-color palette used for image processing:<div class="palette-container" id="palette-container"></div><div class="preview-section"><h3>Preview</h3><div class="preview-gradient" id="preview-gradient"></div><div class="preview-color-values" id="preview-color-values"></div></div></div></div><div id="notification" class="notification">Settings saved successfully!</div><script>let palette=[{r:13,g:43,b:69,a:255},{r:32,g:60,b:86,a:255},{r:84,g:78,b:104,a:255},{r:141,g:105,b:122,a:255},{r:208,g:129,b:89,a:255},{r:255,g:170,b:94,a:255},{r:255,g:212,b:163,a:255},{r:255,g:236,b:214,a:255}];function initPalette(){const e=document.getElementById("palette-container");e.innerHTML="",palette.forEach(((t,a)=>{const n=document.createElement("div");n.className="color-picker";const o=document.createElement("div");o.className="color-block",o.style.backgroundColor=`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a/255})`;const r=document.createElement("input");r.type="color",r.className="color-input",r.value=rgbToHex(t.r,t.g,t.b),r.dataset.index=a,r.addEventListener("input",handleColorChange),o.appendChild(r),n.appendChild(o),e.appendChild(n)})),updatePreviewGradient(),updateColorValues()}function handleColorChange(e){const t=parseInt(e.target.dataset.index),a=hexToRgb(e.target.value);palette[t]={r:a.r,g:a.g,b:a.b,a:255};e.target.parentElement.style.backgroundColor=`rgba(${a.r}, ${a.g}, ${a.b}, 1)`,updatePreviewGradient(),updateColorValues()}function rgbToHex(e,t,a){return"#"+[e,t,a].map((e=>{const t=e.toString(16);return 1===t.length?"0"+t:t})).join("")}function hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function updatePreviewGradient(){const e=document.getElementById("preview-gradient"),t=palette.map(((e,t)=>{const a=t/(palette.length-1)*100;return`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a/255}) ${a}%`})).join(", ");e.style.background=`linear-gradient(to right, ${t})`}function updateColorValues(){const e=document.getElementById("preview-color-values");e.innerHTML="",palette.forEach(((t,a)=>{const n=document.createElement("div");n.className="preview-color-value",n.textContent=`${a}: RGB(${t.r}, ${t.g}, ${t.b})`,n.style.color=getBrightness(t)<128?"#fff":"#000",n.style.backgroundColor=`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a/255})`,e.appendChild(n)}))}function getBrightness(e){return Math.sqrt(e.r*e.r*.299+e.g*e.g*.587+e.b*e.b*.114)}async function savePalette(){try{(await fetch("/save-palette",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({palette:palette})})).ok?showNotification("Settings saved successfully!"):showNotification("Failed to save settings","error")}catch(e){console.error("Error saving palette:",e),showNotification("Error saving settings","error")}}async function resetPalette(){try{const e=await fetch("/reset-palette",{method:"POST"});if(e.ok){const t=await e.json();t.palette&&(palette=t.palette,initPalette(),showNotification("Palette reset to default values"))}else showNotification("Failed to reset palette","error")}catch(e){console.error("Error resetting palette:",e),showNotification("Error resetting palette","error")}}async function loadPalette(){try{const e=await fetch("/get-palette");if(e.ok){const t=await e.json();t.palette&&(palette=t.palette)}}catch(e){console.error("Error loading palette:",e)}initPalette()}function showNotification(e,t="success"){const a=document.getElementById("notification");a.textContent=e,a.style.backgroundColor="success"===t?"var(--success-color)":"var(--danger-color)",a.classList.add("show"),setTimeout((()=>{a.classList.remove("show")}),3e3)}document.addEventListener("DOMContentLoaded",(()=>{loadPalette(),document.getElementById("savePaletteBtn").addEventListener("click",savePalette),document.getElementById("resetPaletteBtn").addEventListener("click",resetPalette)}))</script>